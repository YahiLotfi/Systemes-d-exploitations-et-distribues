#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/socket.h>
#include <arpa/inet.h>

#define SERVER_IP "127.0.0.1"
#define PORT 8080

int main(int argc, char const *argv[]) {
    int socket_fd;
    int n;
    struct sockaddr_in server_address;
    char message1[1024];
    char message2[1024];
    char buffer[1024] = {0};
    char buffer2[100] = {0};
    int read_size;
    
    // Créer un socket client
    if ((socket_fd = socket(AF_INET, SOCK_STREAM, 0)) < 0) {
        perror("Erreur lors de la création du socket client");
        exit(EXIT_FAILURE);
    }

    memset(&server_address, '0', sizeof(server_address));

    server_address.sin_family = AF_INET;
    server_address.sin_port = htons(PORT);

    // Convertir l'adresse IP du serveur en une structure sockaddr_in
    if (inet_pton(AF_INET, SERVER_IP, &server_address.sin_addr) <= 0) {
        perror("Erreur lors de la conversion de l'adresse IP");
        exit(EXIT_FAILURE);
    }

    // Établir la connexion avec le serveur
    if (connect(socket_fd, (struct sockaddr *)&server_address, sizeof(server_address)) < 0) {
        perror("Erreur lors de l'établissement de la connexion avec le serveur");
        exit(EXIT_FAILURE);
    }

 
    do{
        printf("1- afficher la liste des bieres\n");
    printf("2- commander biere\n");
    printf("3- quitter\n");
    scanf("%d",&n );
    // Demander à l'utilisateur d'entrer une chaîne de caractères

    if(n==2){
    printf("entrer le nom de la biere à commander\n");
    printf("exemple : Goudale demi\n");
    
    getchar();
fgets(message1, 1024, stdin);
message1[sizeof(message1)-1] = '\0';

 send(socket_fd, message1, strlen(message1), 0);


    
    
    if ((read_size = recv(socket_fd, buffer, 1024, 0)) > 0) {
        printf(" %s\n", buffer);
    }
}else if (n==1){
strcpy(message1, "afficher liste biere\0");
if ((read_size = recv(socket_fd, buffer2, 1024, 0)) > 0) {
        printf("la Liste est: %s\n", buffer2);
    }

}
    // Fermer la connexion avec le serveur
   
}while (n!=3);
close(socket_fd);
    return 0;
}

